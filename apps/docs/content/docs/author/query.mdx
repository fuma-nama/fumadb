---
title: Querying Database
description: FumaDB provides a Prisma-like query interface for interacting with consumer's database.
---

## Basic Usage

To interact with the ORM:

1. Get the active schema version.
2. Get the ORM instance for the given version.

```ts
const version = await client.version();

const orm = client.orm(version);
```

It's useful when you have multiple versions and want to ensure backward compatibility.

```ts
const version = await client.version();

if (version === "1.0.0") {
  const orm = client.orm(version);
  // ...
} else if (version === "1.1.0") {
  const orm = client.orm(version);
  // ...
}
```

### Create

```ts
const createdUser = await orm.create("users", {
  name: "fuma",
});
```

### Create Many

```ts
await orm.createMany("users", [
  { id: "alfon", name: "alfon" },
  { id: "bob", name: "bob" },
]);
```

### Find Many

```ts
const allUsers = await orm.findMany("users", {
  select: true, // or ["id", "name"]
  orderBy: [users.name, "asc"],
});
```

- `select`: true, or array of column names
- `where`: (builder) => condition
- `orderBy`: [[column, "asc" | "desc"]]
- `limit`, `offset`
- `join`: (builder) => builder.relation(...)

### Find First

Same as `findMany` but only return the first result in the query.

```ts
const user = await orm.findFirst("users", {
  where: (b) => b("id", "=", "alfon"),
});
```

### Update Many

```ts
await orm.updateMany("users", {
  set: { name: "Bob" },
  where: (b) => b("id", "=", "alfon"),
});
```

### Upsert

```ts
await orm.upsert("users", {
  where: (b) => b("id", "=", "bob"),
  create: { id: "bob", name: "Bob is sad" },
  update: { name: "Bob is happy" },
});
```

### Count

```ts
const count = await orm.count("users", {
  where: (b) => b.isNotNull("name"),
});
```

### Delete Many

```ts
await orm.deleteMany("users", {
  where: (b) => b("id", "=", "bob"),
});
```

## Filtering & Conditions

The query builder (`b`) supports logical operators and comparisons:

```ts
const filtered = await orm.findMany("users", {
  where: (b) =>
    b.and(
      b("name", "contains", "al"),
      b.or(b("age", ">", 100), b.isNull("email"))
    ),
});
```

Supported operators include:

- `=`
- `!=`
- `>`
- `>=`
- `<`
- `<=`
- `in`
- `not in`
- `contains`
- `starts with`
- `ends with`
- `not contains`
- `not starts with`
- `not ends with`

## Joins (Relations)

For relations, make sure to [declare relations](/docs/author/schema#relations) in your schema first.

```ts
// Get users with their messages
const result = await orm.findMany("users", {
  join: (b) => b.messages(),
});

// Nested join with select and where
const result = await orm.findMany("users", {
  join: (b) =>
    b.messages({
      select: ["content"],
      limit: 1,
      where: (b) => b("content", "contains", "alfon"),
      join: (b) => b.author(),
    }),
});
```
